from Crypto.Util.number import bytes_to_long as btl, long_to_bytes as ltb, inverse
from owiener import  isqrt
fp = open('output.txt','r')
e = 65537
lines = fp.read().split('\n')[:-1]
p_plus_q = int(lines[0][8:])
n = int(lines[1][4:])
c = int(lines[2][4:])
p_minus_q = isqrt(pow(p_plus_q,2)-4*n)
p = (p_plus_q+p_minus_q)//2
q = n//p
tot = (q-1)*(p-1)
d = inverse(e,tot)
flag = ltb(pow(c,d,n)).decode()
print(f'flag: {flag}')
