from pwn import *
host,port = 'puzzler7.imaginaryctf.org',2500
p = None
try:
    p = remote(host,port)
    p.recvuntil(b'!\n')
    for i in range(100):
        problem = p.recvline().rstrip()
        answer = eval(problem)
        print(f'{problem=}\n{answer=}')
        p.sendline(str(answer).encode())
    p.recvuntil(b'flag: ')
    flag = p.recvline().rstrip().decode()
    print(f'[0] flag: {flag}')
    flag = p.recvline().rstrip().decode()
    print(f'[1] flag: {flag}')
    log.info(f'{p.clean()=}')
    p.close()
except Exception as e:
    print(f'Exception: {e}')
